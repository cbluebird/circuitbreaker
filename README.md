# circuitbreaker
熔断器

这是微精弘熔断器的实现,用于对多条api线路的监控检测与切换,需要实现以下的功能:

- 注册api到熔断器中(api的URL)
- 注册请求方法到熔断器中(api的正常响应,方法类型,是否需要cookie),请求的URL地址通过注册的健康的api的URL负载均衡后得到
- 调用指定的方法,发送请求并判断响应的状态,并记录api的URL的健康情况到counter中
- counter的error数量达到一定的比例后就熔断URL,并设置失败的时间
- 之后在判断api服务的过期时间是否度过恢复时间,并设置为半打开状态,可以放行一两个请求,如果还是失败则重制失败的时间,如果成功则重新添加回到健康的apiMap中